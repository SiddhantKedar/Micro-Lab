;uC Expt 8 LCD

;8051 INTERFACING WITH 16X2 LCD
;RS -> REGISTER SELECT -> EITHER COMMAND (0) OR DATA (1) -> P2.0
;R/W -> EITHER READ OR WRITE , ALWAYS WRITE, ALWAYS ZERO -> P2.1
;EN -> ENABLE PIN, TO BE SET TO ONE, LOW TO HIGH PULSE -> P2.2
;DATA REGISTERS -> PORT 3

	ORG	0000H
HERE:	LCALL	COMMANDWR1
	LCALL	DATAWR1
	LCALL	COMMANDWR2
	LCALL	DATAWR2
	SJMP	HERE

	ORG	0020H
COMMANDWR1:	MOV	DPTR, #COMMANDWORD1
REP1:	CLR	A
	MOVC	A, @A+DPTR
	JZ	LAST1
	MOV	P3, A
	CLR	P2.0		;RS=0 TO SELECT DATA REGISTER
	CLR	P2.1		;R/W =0 TO WRITE IN COMMAND REGISTER
	SETB	P2.2		; HIGH TO LOW PULSE ON EN PIN (HIGH)
	LCALL	DELAY
	CLR	P2.2		; (LOW)
	INC	DPTR
	SJMP	REP1
LAST1:	RET

	ORG	0050H
DATAWR1:	MOV	DPTR, #DATAWORD1
REP2:	CLR	A
	MOVC	A, @A+DPTR
	JZ	LAST2
	MOV	P3, A
	SETB	P2.0		;RS=1 TO SELECT DATA REGISTER
	CLR	P2.1		;R/W =0 TO WRITE IN COMMAND REGISTER
	SETB	P2.2		; HIGH TO LOW PULSE ON EN PIN (HIGH)
	LCALL	DELAY
	CLR	P2.2		; (LOW)
	INC	DPTR
	SJMP	REP2
LAST2:	RET

	ORG	0080H
COMMANDWR2:	MOV	DPTR, #COMMANDWORD2
REP3:	CLR	A
	MOVC	A, @A+DPTR
	JZ	LAST3
	MOV	P3, A
	CLR	P2.0		;RS=0 TO SELECT DATA REGISTER
	CLR	P2.1		;R/W =0 TO WRITE IN COMMAND REGISTER
	SETB	P2.2		; HIGH TO LOW PULSE ON EN PIN (HIGH)
	LCALL	DELAY
	CLR	P2.2		; (LOW)
	INC	DPTR
	SJMP	REP3
LAST3:	RET

	ORG	00B0H
DATAWR2:	MOV	DPTR, #DATAWORD2
REP4:	CLR	A
	MOVC	A, @A+DPTR
	JZ	LAST4
	MOV	P3, A
	SETB	P2.0		;RS=1 TO SELECT DATA REGISTER
	CLR	P2.1		;R/W =0 TO WRITE IN COMMAND REGISTER
	SETB	P2.2		; HIGH TO LOW PULSE ON EN PIN (HIGH)
	LCALL	DELAY
	CLR	P2.2		; (LOW)
	INC	DPTR
	SJMP	REP4
LAST4:	RET

	ORG	00E0H
COMMANDWORD1:	DB	01H, 38H, 0FH, 83H, 00H	;01 -> CLEARS SCREEN, 38H -> 16x2 lcd with 5x7 matrix, 0Fh -> display on, cursor on, 83h -> display on first row, fourth column

	ORG	00F0H
DATAWORD1:	DB	'THANK YOU', 00H

	ORG	0100H
COMMANDWORD2:	DB	38H, 0FH, 0C2H, 00H	;C2h -> display on second row, second column


	ORG	0110H
DATAWORD2:	DB	'VERY MUCH', 00H

	ORG	0130H
DELAY:	MOV	R1, #255D
B1:	DJNZ	R1, B1
	RET
	END

